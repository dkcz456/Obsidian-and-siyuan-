# 002-ä»»åŠ¡åˆ†è§£ä¸å¼€å‘è®¡åˆ’

## Document Relationships
- **Parent Documents**: 
  - `001-project-overview-and-setup.md` - é¡¹ç›®æ¦‚è§ˆä¸ç¯å¢ƒè®¾ç½®
- **Related Documents**: 
  - `å¼€å‘æ–‡æ¡£/æ€è·¯è®¾è®¡/1.md` - æ ¸å¿ƒè®¾è®¡å“²å­¦
  - `å¼€å‘æ–‡æ¡£/æ€è·¯è®¾è®¡/2.md` - Phase 1 å®æ–½æŒ‡å—
- **Child Documents**: 
  - `003-technical-architecture.md` - æŠ€æœ¯æ¶æ„è®¾è®¡
  - `004-development-progress-tracking.md` - å¼€å‘è¿›åº¦è·Ÿè¸ª
- **Status**: âœ… Created | ğŸ“ In Progress | â³ Pending

---

## å¼€å‘é˜¶æ®µæ€»è§ˆ

### Phase 1: Foundation Setup ğŸ—ï¸
**ç›®æ ‡**: å»ºç«‹æ’ä»¶åŸºç¡€æ¶æ„å’Œå¼€å‘ç¯å¢ƒ
**é¢„ä¼°æ—¶é—´**: 2-3 å°æ—¶
**ä¼˜å…ˆçº§**: ğŸ”´ Critical

### Phase 2: Core Card Library Implementation ğŸ“š
**ç›®æ ‡**: å®ç°å…¨å±€å¡ç‰‡åº“æ ¸å¿ƒåŠŸèƒ½
**é¢„ä¼°æ—¶é—´**: 4-5 å°æ—¶
**ä¼˜å…ˆçº§**: ğŸ”´ Critical

### Phase 3: Context-Aware Filtering System ğŸ”
**ç›®æ ‡**: æ·»åŠ æ™ºèƒ½ç­›é€‰å’Œæœç´¢åŠŸèƒ½
**é¢„ä¼°æ—¶é—´**: 3-4 å°æ—¶
**ä¼˜å…ˆçº§**: ğŸŸ¡ High

### Phase 4: Enhanced Canvas Integration ğŸ¨
**ç›®æ ‡**: å®ç°ç”»å¸ƒé›†æˆå’Œæ‹–æ‹½åŠŸèƒ½
**é¢„ä¼°æ—¶é—´**: 4-5 å°æ—¶
**ä¼˜å…ˆçº§**: ğŸ”´ Critical

### Phase 5: Testing and Refinement ğŸ§ª
**ç›®æ ‡**: æµ‹è¯•ã€ä¼˜åŒ–å’Œç”Ÿäº§å‡†å¤‡
**é¢„ä¼°æ—¶é—´**: 2-3 å°æ—¶
**ä¼˜å…ˆçº§**: ğŸŸ¡ High

---

## è¯¦ç»†ä»»åŠ¡åˆ†è§£

## Phase 1: Foundation Setup

### 1.1 Update plugin metadata and configuration
**æ—¶é—´**: ~20 åˆ†é’Ÿ
**æè¿°**: æ›´æ–°æ’ä»¶åŸºç¡€é…ç½®æ–‡ä»¶
**å…·ä½“ä»»åŠ¡**:
- [ ] ä¿®æ”¹ `manifest.json`: æ›´æ–° id, name, description, author
- [ ] æ›´æ–° `package.json`: ä¿®æ”¹ name, description, keywords
- [ ] ç¡®è®¤ Obsidian API ç‰ˆæœ¬å…¼å®¹æ€§

### 1.2 Restructure main.ts with core plugin architecture
**æ—¶é—´**: ~30 åˆ†é’Ÿ
**æè¿°**: é‡æ„ä¸»æ’ä»¶æ–‡ä»¶ï¼Œå»ºç«‹æ ¸å¿ƒæ¶æ„
**å…·ä½“ä»»åŠ¡**:
- [ ] ç§»é™¤ç¤ºä¾‹ä»£ç ï¼Œä¿ç•™åŸºç¡€æ’ä»¶ç»“æ„
- [ ] æ·»åŠ æ’ä»¶è®¾ç½®æ¥å£å®šä¹‰
- [ ] åˆ›å»ºæ’ä»¶ä¸»ç±»åŸºç¡€ç»“æ„
- [ ] æ·»åŠ è§†å›¾ç±»å‹å¸¸é‡å®šä¹‰

### 1.3 Set up TypeScript interfaces and types
**æ—¶é—´**: ~25 åˆ†é’Ÿ
**æè¿°**: å®šä¹‰æ ¸å¿ƒæ•°æ®ç»“æ„å’Œç±»å‹
**å…·ä½“ä»»åŠ¡**:
- [ ] å®šä¹‰ `CardData` æ¥å£ï¼ˆæ–‡ä»¶å¡å’ŒåŸç”Ÿå¡ï¼‰
- [ ] å®šä¹‰ `CanvasNode` æ¥å£ï¼ˆç¬¦åˆ Canvas æ ¼å¼ï¼‰
- [ ] å®šä¹‰ `FilterState` æ¥å£ï¼ˆç­›é€‰çŠ¶æ€ï¼‰
- [ ] å®šä¹‰ `PluginSettings` æ¥å£

### 1.4 Create basic CSS structure
**æ—¶é—´**: ~15 åˆ†é’Ÿ
**æè¿°**: å»ºç«‹æ ·å¼åŸºç¡€ç»“æ„
**å…·ä½“ä»»åŠ¡**:
- [ ] æ¸…ç†ç¤ºä¾‹æ ·å¼
- [ ] æ·»åŠ å¡ç‰‡åº“åŸºç¡€æ ·å¼ç±»
- [ ] æ·»åŠ å“åº”å¼è®¾è®¡åŸºç¡€
- [ ] è®¾ç½® CSS å˜é‡å’Œä¸»é¢˜é€‚é…

## Phase 2: Core Card Library Implementation

### 2.1 Create CardLibraryView class structure
**æ—¶é—´**: ~25 åˆ†é’Ÿ
**æè¿°**: å®ç°å¡ç‰‡åº“è§†å›¾åŸºç¡€ç»“æ„
**å…·ä½“ä»»åŠ¡**:
- [ ] åˆ›å»º `CardLibraryView` ç±»ç»§æ‰¿ `ItemView`
- [ ] å®ç° `getViewType()`, `getDisplayText()`, `getIcon()`
- [ ] å®ç° `onOpen()` å’Œ `onClose()` ç”Ÿå‘½å‘¨æœŸ
- [ ] æ·»åŠ å®¹å™¨å…ƒç´ åˆå§‹åŒ–

### 2.2 Implement basic card listing functionality
**æ—¶é—´**: ~30 åˆ†é’Ÿ
**æè¿°**: å®ç°åŸºç¡€å¡ç‰‡åˆ—è¡¨æ˜¾ç¤º
**å…·ä½“ä»»åŠ¡**:
- [ ] å®ç° `renderCardList()` æ–¹æ³•
- [ ] è·å–æ‰€æœ‰ Markdown æ–‡ä»¶
- [ ] åˆ›å»ºå¡ç‰‡é¡¹ DOM å…ƒç´ 
- [ ] æ·»åŠ å¡ç‰‡é¡¹åŸºç¡€æ ·å¼

### 2.3 Add drag and drop event handling
**æ—¶é—´**: ~25 åˆ†é’Ÿ
**æè¿°**: å®ç°æ‹–æ‹½äº‹ä»¶å¤„ç†
**å…·ä½“ä»»åŠ¡**:
- [ ] ä¸ºå¡ç‰‡é¡¹æ·»åŠ  `draggable` å±æ€§
- [ ] å®ç° `dragstart` äº‹ä»¶ç›‘å¬
- [ ] è®¾ç½® `dataTransfer` æ•°æ®æ ¼å¼
- [ ] æ·»åŠ æ‹–æ‹½è§†è§‰åé¦ˆ

### 2.4 Register view and add ribbon icon
**æ—¶é—´**: ~20 åˆ†é’Ÿ
**æè¿°**: æ³¨å†Œè§†å›¾å¹¶æ·»åŠ è®¿é—®å…¥å£
**å…·ä½“ä»»åŠ¡**:
- [ ] åœ¨æ’ä»¶ `onload` ä¸­æ³¨å†Œè§†å›¾
- [ ] æ·»åŠ  Ribbon å›¾æ ‡
- [ ] å®ç° `activateCardLibraryView()` æ–¹æ³•
- [ ] æµ‹è¯•è§†å›¾æ‰“å¼€å’Œå…³é—­

## Phase 3: Context-Aware Filtering System

### 3.1 Add canvas selector dropdown
**æ—¶é—´**: ~30 åˆ†é’Ÿ
**æè¿°**: åˆ›å»ºç”»å¸ƒé€‰æ‹©ä¸‹æ‹‰èœå•
**å…·ä½“ä»»åŠ¡**:
- [ ] åœ¨å¡ç‰‡åº“é¡¶éƒ¨æ·»åŠ ç­›é€‰å™¨å®¹å™¨
- [ ] åˆ›å»ºç”»å¸ƒé€‰æ‹©ä¸‹æ‹‰èœå•
- [ ] è·å–æ‰€æœ‰ `.canvas` æ–‡ä»¶å¹¶å¡«å……é€‰é¡¹
- [ ] æ·»åŠ é€‰æ‹©å˜åŒ–äº‹ä»¶ç›‘å¬

### 3.2 Implement canvas-specific card filtering
**æ—¶é—´**: ~35 åˆ†é’Ÿ
**æè¿°**: å®ç°ç”»å¸ƒç‰¹å®šçš„å¡ç‰‡ç­›é€‰
**å…·ä½“ä»»åŠ¡**:
- [ ] ä¿®æ”¹ `renderCardList()` æ”¯æŒç­›é€‰æ¨¡å¼
- [ ] å®ç°ç”»å¸ƒæ–‡ä»¶è§£æé€»è¾‘
- [ ] æå–ç”»å¸ƒä¸­çš„æ–‡ä»¶èŠ‚ç‚¹å’Œæ–‡æœ¬èŠ‚ç‚¹
- [ ] åŒºåˆ†æ˜¾ç¤ºæ–‡ä»¶å¡å’ŒåŸç”Ÿå¡

### 3.3 Add native tag integration
**æ—¶é—´**: ~30 åˆ†é’Ÿ
**æè¿°**: é›†æˆ Obsidian åŸç”Ÿæ ‡ç­¾ç³»ç»Ÿ
**å…·ä½“ä»»åŠ¡**:
- [ ] æ‰«æå½“å‰è§†å›¾ä¸­å¡ç‰‡çš„æ ‡ç­¾
- [ ] åˆ›å»ºæ ‡ç­¾ç­›é€‰ UI ç»„ä»¶
- [ ] å®ç°æ ‡ç­¾ç‚¹å‡»ç­›é€‰é€»è¾‘
- [ ] æ·»åŠ æ ‡ç­¾é«˜äº®æ˜¾ç¤º

### 3.4 Create search functionality
**æ—¶é—´**: ~25 åˆ†é’Ÿ
**æè¿°**: æ·»åŠ å®æ—¶æœç´¢åŠŸèƒ½
**å…·ä½“ä»»åŠ¡**:
- [ ] æ·»åŠ æœç´¢æ¡† UI ç»„ä»¶
- [ ] å®ç°å®æ—¶æœç´¢äº‹ä»¶ç›‘å¬
- [ ] æ·»åŠ æœç´¢ç»“æœé«˜äº®
- [ ] ä¼˜åŒ–æœç´¢æ€§èƒ½ï¼ˆé˜²æŠ–ï¼‰

## Phase 4: Enhanced Canvas Integration

### 4.1 Implement canvas drop zone handling
**æ—¶é—´**: ~30 åˆ†é’Ÿ
**æè¿°**: å®ç°ç”»å¸ƒæ‹–æ”¾åŒºåŸŸå¤„ç†
**å…·ä½“ä»»åŠ¡**:
- [ ] è·å–æ´»åŠ¨ç”»å¸ƒè§†å›¾å¼•ç”¨
- [ ] æ·»åŠ  `dragover` äº‹ä»¶ç›‘å¬
- [ ] æ·»åŠ  `drop` äº‹ä»¶ç›‘å¬
- [ ] å¤„ç†æ‹–æ”¾æ•°æ®éªŒè¯

### 4.2 Create node generation logic
**æ—¶é—´**: ~35 åˆ†é’Ÿ
**æè¿°**: å®ç°ç”»å¸ƒèŠ‚ç‚¹ç”Ÿæˆé€»è¾‘
**å…·ä½“ä»»åŠ¡**:
- [ ] å®ç°æ–‡ä»¶èŠ‚ç‚¹ç”Ÿæˆå‡½æ•°
- [ ] å®ç°æ–‡æœ¬èŠ‚ç‚¹ç”Ÿæˆå‡½æ•°
- [ ] æ·»åŠ å”¯ä¸€ ID ç”Ÿæˆé€»è¾‘
- [ ] ç¡®ä¿èŠ‚ç‚¹æ ¼å¼ç¬¦åˆ Canvas è§„èŒƒ

### 4.3 Add canvas data persistence
**æ—¶é—´**: ~30 åˆ†é’Ÿ
**æè¿°**: å®ç°ç”»å¸ƒæ•°æ®æŒä¹…åŒ–
**å…·ä½“ä»»åŠ¡**:
- [ ] å®ç°ç”»å¸ƒæ•°æ®è¯»å–åŠŸèƒ½
- [ ] å®ç°ç”»å¸ƒæ•°æ®ä¿å­˜åŠŸèƒ½
- [ ] æ·»åŠ  JSON æ ¼å¼éªŒè¯
- [ ] å¤„ç†æ–‡ä»¶è¯»å†™é”™è¯¯

### 4.4 Handle coordinate calculation
**æ—¶é—´**: ~25 åˆ†é’Ÿ
**æè¿°**: å®ç°åæ ‡è®¡ç®—é€»è¾‘
**å…·ä½“ä»»åŠ¡**:
- [ ] è·å–é¼ æ ‡åœ¨ç”»å¸ƒä¸­çš„åæ ‡
- [ ] å®ç°åæ ‡è½¬æ¢é€»è¾‘
- [ ] å¤„ç†ç”»å¸ƒç¼©æ”¾å’Œå¹³ç§»
- [ ] æ·»åŠ èŠ‚ç‚¹ä½ç½®ä¼˜åŒ–

## Phase 5: Testing and Refinement

### 5.1 Write unit tests for core functionality
**æ—¶é—´**: ~40 åˆ†é’Ÿ
**æè¿°**: ç¼–å†™æ ¸å¿ƒåŠŸèƒ½å•å…ƒæµ‹è¯•
**å…·ä½“ä»»åŠ¡**:
- [ ] æµ‹è¯•å¡ç‰‡åº“è§†å›¾åˆ›å»ºå’Œæ¸²æŸ“
- [ ] æµ‹è¯•ç­›é€‰å’Œæœç´¢åŠŸèƒ½
- [ ] æµ‹è¯•æ‹–æ‹½æ•°æ®å¤„ç†
- [ ] æµ‹è¯•ç”»å¸ƒèŠ‚ç‚¹ç”Ÿæˆ

### 5.2 Perform integration testing
**æ—¶é—´**: ~30 åˆ†é’Ÿ
**æè¿°**: æ‰§è¡Œé›†æˆæµ‹è¯•
**å…·ä½“ä»»åŠ¡**:
- [ ] æµ‹è¯•å®Œæ•´çš„æ‹–æ‹½å·¥ä½œæµ
- [ ] æµ‹è¯•ä¸åŒå†…å®¹ç±»å‹å¤„ç†
- [ ] æµ‹è¯•é”™è¯¯åœºæ™¯å¤„ç†
- [ ] éªŒè¯ Canvas æ ¼å¼å…¼å®¹æ€§

### 5.3 Optimize performance and memory usage
**æ—¶é—´**: ~25 åˆ†é’Ÿ
**æè¿°**: æ€§èƒ½ä¼˜åŒ–å’Œå†…å­˜ç®¡ç†
**å…·ä½“ä»»åŠ¡**:
- [ ] åˆ†æå¤§å‹åº“çš„æ€§èƒ½è¡¨ç°
- [ ] ä¼˜åŒ–å¡ç‰‡æ¸²æŸ“æ€§èƒ½
- [ ] å®ç°è™šæ‹Ÿæ»šåŠ¨ï¼ˆå¦‚éœ€è¦ï¼‰
- [ ] ä¼˜åŒ–å†…å­˜ä½¿ç”¨

### 5.4 Bug fixes and edge case handling
**æ—¶é—´**: ~25 åˆ†é’Ÿ
**æè¿°**: ä¿®å¤é—®é¢˜å’Œå¤„ç†è¾¹ç•Œæƒ…å†µ
**å…·ä½“ä»»åŠ¡**:
- [ ] ä¿®å¤æµ‹è¯•ä¸­å‘ç°çš„é—®é¢˜
- [ ] å¤„ç†ç©ºæ–‡ä»¶å’ŒæŸåæ–‡ä»¶
- [ ] æ·»åŠ ç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤º
- [ ] å®Œå–„å¼‚å¸¸å¤„ç†æœºåˆ¶

---

## å¼€å‘é‡Œç¨‹ç¢‘

- **Milestone 1**: åŸºç¡€æ¶æ„å®Œæˆ (Phase 1)
- **Milestone 2**: å¡ç‰‡åº“å¯ç”¨ (Phase 2)
- **Milestone 3**: ç­›é€‰ç³»ç»Ÿå°±ç»ª (Phase 3)
- **Milestone 4**: ç”»å¸ƒé›†æˆå®Œæˆ (Phase 4)
- **Milestone 5**: ç”Ÿäº§å°±ç»ª (Phase 5)

---

**åˆ›å»ºæ—¶é—´**: 2025-01-18  
**æœ€åæ›´æ–°**: 2025-01-18  
**çŠ¶æ€**: ğŸ“ ä»»åŠ¡è§„åˆ’å®Œæˆï¼Œç­‰å¾…å¼€å‘å¯åŠ¨
